import numpy as np
import matplotlib.pyplot as plt

e1 = {
    "name": "raaj",
    "command:": "python train_raaj.py --exp_name raaj --nepoch 50 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4",
    "extra": "No other additions used",
    "test_interval": 5000,
    "rmse": [5.093856334686279, 4.498722076416016, 3.083822727203369, 2.7413127422332764, 2.699984073638916, 2.597834587097168, 2.502667188644409, 2.40141224861145, 3.5991766452789307, 2.275947332382202, 2.1963088512420654, 2.1019134521484375, 2.2240593433380127, 2.21748948097229, 2.290454149246216, 2.2462806701660156, 2.271103620529175, 2.185169219970703, 2.7858524322509766, 2.1395342350006104, 1.9764498472213745, 2.062957763671875, 2.163479804992676, 2.016000270843506, 1.8703045845031738, 2.0646743774414062, 1.8944143056869507, 2.0399537086486816, 2.13730788230896, 2.215651035308838, 2.3261260986328125, 1.9579334259033203, 2.0737788677215576, 1.9619027376174927, 1.9028606414794922, 2.306797504425049, 1.9389979839324951, 1.914262056350708, 2.009633779525757, 1.9145698547363281, 2.2240750789642334, 2.0640437602996826, 2.088416576385498, 1.900465488433838, 1.8838390111923218, 1.9438542127609253, 1.928377628326416, 2.0189850330352783, 1.970539927482605, 1.930024266242981, 1.9758362770080566, 1.9911922216415405, 1.9003195762634277, 1.9827296733856201, 1.9804960489273071, 1.8695687055587769, 1.864070177078247, 1.9628667831420898, 1.8480559587478638, 2.0715315341949463, 1.9965542554855347, 2.025421142578125, 2.006564140319824, 2.110764265060425, 1.9030420780181885],
    "sil": [0.26158812642097473, 0.1967812180519104, 0.11199184507131577, 0.09861795604228973, 0.09121604263782501, 0.08876412361860275, 0.08955056220293045, 0.0839523896574974, 0.12163680791854858, 0.0854288637638092, 0.08202575892210007, 0.07952307909727097, 0.07677242904901505, 0.07840321958065033, 0.08456078916788101, 0.07965028285980225, 0.07862308621406555, 0.07501637190580368, 0.09091439843177795, 0.0761035606265068, 0.07181143015623093, 0.07430735230445862, 0.075571209192276, 0.0726388469338417, 0.06761518120765686, 0.07377977669239044, 0.06762176752090454, 0.07432842254638672, 0.07548517733812332, 0.07138464599847794, 0.07756990194320679, 0.0711631178855896, 0.07281386852264404, 0.07083477079868317, 0.07010123133659363, 0.07605704665184021, 0.07219196110963821, 0.06702496111392975, 0.07214230298995972, 0.0678308755159378, 0.07449886947870255, 0.06777307391166687, 0.07074231654405594, 0.06976455450057983, 0.06713029742240906, 0.07206238806247711, 0.07098595798015594, 0.07062333822250366, 0.07174233347177505, 0.06837059557437897, 0.06968435645103455, 0.0753200352191925, 0.06763149797916412, 0.06898319721221924, 0.0694018229842186, 0.06712765991687775, 0.06486472487449646, 0.06982579082250595, 0.07017087936401367, 0.0713549330830574, 0.07224582135677338, 0.07089046388864517, 0.06899663805961609, 0.07482430338859558, 0.06527712196111679]
}

e2 = {
    "name": "raaj_mf1",
    "command:": "python train_raaj.py --exp_name raaj_mf1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 96 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_mf1",
    "extra": "ndepth 96 - No other additions used",
    "test_interval": 5000,
    "rmse": [5.195703983306885, 4.65868616104126, 3.5377135276794434, 2.9341824054718018, 2.706258773803711, 2.7388365268707275, 2.478070020675659, 3.417593002319336, 2.337862730026245, 2.296541213989258, 2.2968318462371826, 2.1265294551849365, 1.9956861734390259, 2.0230345726013184, 2.0877022743225098, 2.2974414825439453, 2.185784339904785, 2.1518218517303467, 2.120391845703125, 2.8898069858551025, 2.143223285675049, 1.982950210571289, 2.0073487758636475, 1.895858645439148, 2.049379587173462, 2.001389980316162, 2.071648597717285, 2.0930521488189697, 1.9212950468063354, 2.0387630462646484, 2.0552120208740234, 2.197216510772705, 1.9162636995315552, 1.8529934883117676, 2.0352776050567627, 1.8198702335357666, 2.133460760116577, 1.9431431293487549, 1.9804474115371704, 1.93356192111969, 2.0305659770965576, 1.8587629795074463, 1.9496488571166992, 2.105231761932373, 1.9596668481826782, 1.9199841022491455, 1.8950260877609253, 1.9052691459655762, 1.959879755973816, 2.010012626647949, 2.1151413917541504, 2.219541072845459, 1.9793587923049927, 1.9591171741485596, 2.0528318881988525, 1.9239814281463623, 1.7886089086532593, 2.04669189453125, 1.9935311079025269, 1.9541095495224, 1.8900656700134277, 1.8139231204986572],
    "sil": [0.27039363980293274, 0.20631657540798187, 0.12628380954265594, 0.10728859156370163, 0.09529860317707062, 0.10000000894069672, 0.08586668968200684, 0.12243708968162537, 0.08655080199241638, 0.08091390877962112, 0.08397180587053299, 0.0800696313381195, 0.07430945336818695, 0.07086760550737381, 0.07383409142494202, 0.08192123472690582, 0.07794768363237381, 0.07369215041399002, 0.07508103549480438, 0.10418067872524261, 0.07889533787965775, 0.07048554718494415, 0.07327713817358017, 0.06834347546100616, 0.0737384706735611, 0.07064533978700638, 0.07042582333087921, 0.0725897029042244, 0.06785178929567337, 0.06831105053424835, 0.06952415406703949, 0.08038594573736191, 0.0697150006890297, 0.06809490919113159, 0.0752694308757782, 0.06555580347776413, 0.07347354292869568, 0.06977535784244537, 0.0682215541601181, 0.06817197054624557, 0.07164578139781952, 0.06492552161216736, 0.06528902798891068, 0.07303399592638016, 0.07138415426015854, 0.06844847649335861, 0.06652173399925232, 0.06806715577840805, 0.06798312067985535, 0.06797600537538528, 0.07175613194704056, 0.07280725240707397, 0.06797964870929718, 0.0669531375169754, 0.06556729972362518, 0.06749900430440903, 0.06688980758190155, 0.06849171966314316, 0.07143059372901917, 0.07240311801433563, 0.06839664280414581, 0.06294700503349304]
}
# No diff

e3 = {
    "name": "raaj_twin1",
    "command": "python train_raaj.py --exp_name raaj_twin1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 1 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_twin1",
    "extra": "window 1 - No other additions used",
    "test_interval": 5000,
    "rmse": [5.105179309844971, 4.006272792816162, 3.088623285293579, 3.138909339904785, 2.646505832672119, 2.5787312984466553, 3.198941946029663, 2.4177796840667725, 2.325347661972046, 2.242929458618164, 2.214945077896118, 2.5018491744995117, 2.200016498565674, 2.1984331607818604, 2.1014132499694824, 2.2034413814544678, 2.0065553188323975, 2.415353536605835, 2.429755926132202, 2.1783206462860107, 2.1212289333343506, 2.046579122543335, 2.143327236175537, 2.046408176422119, 2.2017006874084473, 2.138862371444702, 2.1658174991607666, 2.176759719848633, 2.1712746620178223, 2.0337624549865723, 2.0235559940338135, 2.173267126083374, 2.1039857864379883, 1.9923440217971802, 2.165132761001587, 2.0839178562164307, 2.1456944942474365, 2.0723745822906494, 2.126204013824463, 2.1403629779815674, 2.0826380252838135, 1.9290753602981567, 2.191209077835083, 1.9939044713974, 2.162989854812622, 1.9836809635162354, 2.201716899871826, 2.022477626800537, 1.9430968761444092, 2.027268409729004, 1.8744386434555054, 1.8314805030822754, 2.1197848320007324, 2.0769855976104736, 2.0166168212890625, 2.040288209915161, 2.0873990058898926, 2.197990655899048, 2.026212692260742, 1.9322137832641602, 2.0165188312530518, 1.9234288930892944, 2.0072052478790283, 2.0094757080078125, 2.076672077178955, 1.9973496198654175],
    "sil": [0.24792838096618652, 0.16740867495536804, 0.11379584670066833, 0.10611653327941895, 0.09206517040729523, 0.08814600110054016, 0.11908292770385742, 0.08871482312679291, 0.08389449119567871, 0.0844595655798912, 0.08257250487804413, 0.08625250309705734, 0.07806437462568283, 0.07956703752279282, 0.07933555543422699, 0.07584880292415619, 0.07134933769702911, 0.08105015009641647, 0.08707275986671448, 0.07762641459703445, 0.08123563230037689, 0.07789096236228943, 0.07395145297050476, 0.07417525351047516, 0.07644640654325485, 0.07640951126813889, 0.07125870883464813, 0.07513962686061859, 0.07888054102659225, 0.07366501539945602, 0.07245692610740662, 0.07300794124603271, 0.07093164324760437, 0.06929079443216324, 0.07484788447618484, 0.07409676909446716, 0.07338400930166245, 0.07090247422456741, 0.07307107746601105, 0.07712771743535995, 0.07504631578922272, 0.0733078345656395, 0.07492096722126007, 0.06863073259592056, 0.07529031485319138, 0.07410766929388046, 0.07204100489616394, 0.06938248872756958, 0.07197623699903488, 0.07361017912626266, 0.06924110651016235, 0.06658665835857391, 0.07250573486089706, 0.07014849781990051, 0.07099266350269318, 0.07140034437179565, 0.07203096151351929, 0.07555754482746124, 0.07052288204431534, 0.06789953261613846, 0.07315032929182053, 0.0686427652835846, 0.07738097757101059, 0.06900538504123688, 0.07168947905302048, 0.06886284798383713],
    "rmse_low": [9.387350082397461, 9.48530387878418, 8.949586868286133, 8.85673713684082, 8.761672973632812, 8.486278533935547, 8.643424987792969, 8.406966209411621, 8.662148475646973, 8.66313362121582, 8.373432159423828, 8.346526145935059, 8.494088172912598, 8.38525390625, 8.06932258605957, 8.164669036865234, 7.844440937042236, 8.548027038574219, 8.570855140686035, 8.37795639038086, 8.168303489685059, 8.274438858032227, 8.112232208251953, 8.289798736572266, 8.219616889953613, 8.108441352844238, 7.8657636642456055, 8.318105697631836, 8.176082611083984, 8.382122039794922, 8.319441795349121, 7.992599010467529, 8.005608558654785, 8.238548278808594, 7.907147407531738, 8.324141502380371, 7.928425312042236, 7.953005790710449, 8.23534870147705, 8.343987464904785, 8.298556327819824, 8.20532512664795, 8.118729591369629, 8.171489715576172, 8.029925346374512, 8.145227432250977, 7.9570441246032715, 8.008953094482422, 7.994785785675049, 8.027801513671875, 8.066059112548828, 8.284883499145508, 8.04309368133545, 8.01082706451416, 8.120413780212402, 8.186248779296875, 8.174162864685059, 7.836660385131836, 8.136153221130371, 8.086731910705566, 8.08903694152832, 7.997220993041992, 8.259167671203613, 8.14563274383545, 8.270663261413574, 7.916408061981201],
    "sil_low": [11.010351181030273, 11.009678840637207, 10.861275672912598, 11.058639526367188, 10.872323036193848, 10.943059921264648, 10.905016899108887, 10.753173828125, 10.97367000579834, 10.891971588134766, 10.892780303955078, 10.889336585998535, 10.91043472290039, 10.896462440490723, 10.795509338378906, 10.898025512695312, 10.611405372619629, 10.949257850646973, 10.895898818969727, 10.970108985900879, 10.905513763427734, 11.019758224487305, 10.868256568908691, 10.966979026794434, 10.991874694824219, 11.006052017211914, 10.742094039916992, 10.893148422241211, 10.85714054107666, 10.919564247131348, 10.880197525024414, 10.755440711975098, 10.838709831237793, 10.783918380737305, 10.747679710388184, 11.046639442443848, 10.901399612426758, 10.810190200805664, 10.999687194824219, 10.88733959197998, 10.900594711303711, 10.88924503326416, 10.795316696166992, 10.853818893432617, 10.852339744567871, 10.88115406036377, 10.978691101074219, 10.969971656799316, 10.852956771850586, 10.810371398925781, 10.891799926757812, 10.92623519897461, 10.943622589111328, 10.911148071289062, 10.824097633361816, 10.886970520019531, 10.986698150634766, 10.786054611206055, 10.934383392333984, 10.803182601928711, 10.868988990783691, 10.826774597167969, 10.913909912109375, 10.870797157287598, 10.818607330322266, 10.895665168762207]
}
# No diff - hmm

e4 = {
    "name": "raaj_baseline540",
    "command": "python train_raaj.py --exp_name raaj_baseline540 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_baseline540",
    "extra": "5 to 40",
    "test_interval": 5000,
    "rmse": [4.229862213134766, 3.6222305297851562, 2.0082919597625732, 1.636533260345459, 1.6388236284255981, 1.4344103336334229, 1.4327787160873413, 1.4114216566085815, 1.3435089588165283, 1.66750168800354, 1.32003915309906, 1.7270084619522095, 1.1958893537521362, 1.330750584602356, 1.2440299987792969, 1.2210124731063843, 1.1991040706634521, 1.2017337083816528, 1.3615401983261108, 1.217840552330017, 1.2201138734817505, 1.2543891668319702, 1.1298198699951172, 1.2208038568496704, 1.2628980875015259, 1.144845962524414, 1.1789944171905518, 1.2295364141464233, 1.1730146408081055, 1.130138874053955, 1.3473596572875977, 1.2267149686813354, 1.1690516471862793, 1.2968417406082153, 1.2272688150405884],
    "sil": [0.2511949837207794, 0.18828395009040833, 0.09787227213382721, 0.0741753950715065, 0.07473859190940857, 0.06933587789535522, 0.06963236629962921, 0.0700901597738266, 0.06641983240842819, 0.07536419481039047, 0.0637948289513588, 0.07551348209381104, 0.06082845479249954, 0.06645268201828003, 0.05922376364469528, 0.05942661687731743, 0.05770000070333481, 0.05689742788672447, 0.06679761409759521, 0.05878855660557747, 0.05812681466341019, 0.0603024885058403, 0.0555046945810318, 0.057468514889478683, 0.06528430432081223, 0.055262185633182526, 0.05756218358874321, 0.05736519396305084, 0.05569664016366005, 0.053307369351387024, 0.06070532649755478, 0.05684425309300423, 0.057593900710344315, 0.05765438824892044, 0.05964833125472069],
    "rmse_low": [6.632779598236084, 6.60107421875, 6.503622531890869, 6.241087436676025, 6.003207206726074, 6.29230260848999, 6.127127170562744, 6.150180816650391, 6.264333724975586, 6.199611663818359, 6.021917819976807, 6.283011436462402, 5.93574857711792, 6.119775295257568, 6.209653854370117, 5.973878383636475, 6.018228530883789, 5.977176666259766, 6.2647881507873535, 6.136696815490723, 5.988452434539795, 6.269497871398926, 5.829348087310791, 6.055513381958008, 6.224493503570557, 5.831354141235352, 5.8751654624938965, 6.200830936431885, 5.983264923095703, 6.0962605476379395, 6.149947166442871, 6.015904903411865, 5.975306510925293, 6.192714691162109, 6.2354655265808105],
    "sil_low": [10.900668144226074, 10.931844711303711, 11.020472526550293, 11.003358840942383, 10.840984344482422, 11.028319358825684, 10.936239242553711, 11.026156425476074, 10.919473648071289, 10.939018249511719, 10.840045928955078, 11.01020336151123, 10.919669151306152, 11.01859188079834, 11.12957763671875, 10.88113784790039, 10.966400146484375, 10.776030540466309, 10.965736389160156, 10.935880661010742, 10.905635833740234, 10.925024032592773, 10.769965171813965, 10.952581405639648, 10.897540092468262, 10.809033393859863, 10.844735145568848, 10.88115406036377, 10.835250854492188, 10.97878360748291, 10.786008834838867, 10.811653137207031, 10.80908489227295, 11.088641166687012, 11.011903762817383]
}
# In General 5 to 40 is much better

e5 = {
    "name": "raaj_540_m1",
    "command": " python train_raaj.py --exp_name raaj_540_m1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --drefine m1 --test --pre_trained_folder outputs/saved_models/raaj_540_m1",
    "extra": "5 to 40 and m1",
    "test_interval": 5000,
    "rmse": [4.105212211608887, 3.568232536315918, 2.088038921356201, 1.5752943754196167, 1.5702096223831177, 1.5370473861694336, 1.418892502784729, 1.4028244018554688, 1.4031087160110474, 1.3535025119781494, 1.282649278640747, 2.2237818241119385, 1.2284560203552246, 1.271148920059204, 1.2650411128997803, 1.3118821382522583, 1.223910927772522, 1.2110495567321777, 1.2607561349868774, 1.2063473463058472, 1.2254571914672852, 1.1866544485092163, 1.1906156539916992, 1.21925687789917, 1.2467395067214966, 1.2126215696334839, 1.2432552576065063, 1.2415845394134521, 1.1754215955734253, 1.1725670099258423, 1.5888413190841675, 1.1488279104232788, 1.2134029865264893, 1.2331615686416626, 1.2385475635528564],
    "sil": [0.2358914315700531, 0.1858472377061844, 0.10104960203170776, 0.07478533685207367, 0.07553042471408844, 0.07435166835784912, 0.07038015872240067, 0.0676378458738327, 0.06812285631895065, 0.06707227230072021, 0.062272652983665466, 0.09765560179948807, 0.06194177269935608, 0.06106923520565033, 0.06246740743517876, 0.06286059319972992, 0.059609126299619675, 0.05767040327191353, 0.06556499004364014, 0.05765658617019653, 0.05795292928814888, 0.05763782933354378, 0.0572710745036602, 0.059148382395505905, 0.060543131083250046, 0.05720554664731026, 0.06035512313246727, 0.05845491960644722, 0.056698787957429886, 0.057663366198539734, 0.07239054143428802, 0.05504174530506134, 0.0586506649851799, 0.05901633948087692, 0.061047982424497604],
    "rmse_low": [6.28715705871582, 5.340061187744141, 5.636441707611084, 5.5721354484558105, 5.322903633117676, 5.358699798583984, 5.793642997741699, 5.583754539489746, 5.646772384643555, 5.7928314208984375, 5.416904449462891, 4.867012023925781, 5.537990570068359, 5.317264080047607, 5.584013938903809, 5.303674221038818, 5.718224048614502, 5.2732954025268555, 5.682480335235596, 5.60322904586792, 5.251258850097656, 5.544861316680908, 5.2609453201293945, 5.268185615539551, 5.772985458374023, 5.307675361633301, 5.276197910308838, 5.17387056350708, 5.415724277496338, 5.125151634216309, 5.077411651611328, 5.346170902252197, 5.350520133972168, 5.2349677085876465, 5.521369934082031],
    "sil_low": [11.074728965759277, 10.94328784942627, 10.986061096191406, 10.990301132202148, 10.899333000183105, 10.975531578063965, 10.927848815917969, 11.011000633239746, 10.825115203857422, 11.086544036865234, 10.971060752868652, 10.824156761169434, 10.938796997070312, 10.947114944458008, 10.863883972167969, 10.982586860656738, 10.91864013671875, 10.924561500549316, 10.916727066040039, 10.914888381958008, 10.958062171936035, 10.93350887298584, 10.908646583557129, 10.824254035949707, 10.89043140411377, 10.934623718261719, 10.892966270446777, 11.023200035095215, 10.843644142150879, 10.688716888427734, 10.926237106323242, 10.844612121582031, 10.888269424438477, 10.757411003112793, 10.958722114562988]
}
# Compared to E4, adding M1 improved the rmse_low a fair bit

# e = e1
# time = np.arange(0,len(e["rmse"]))*e["test_interval"]
# #plt.plot(time, e["rmse"])
# plt.plot(time, e["sil"])
# plt.ylabel(e["name"])

e = e4
time = np.arange(0,len(e["rmse"]))*e["test_interval"]
#plt.plot(time, e["rmse"])
plt.plot(time, e["rmse_low"])
plt.ylabel(e["name"])

e = e5
time = np.arange(0,len(e["rmse"]))*e["test_interval"]
#plt.plot(time, e["rmse"])
plt.plot(time, e["rmse_low"])
plt.ylabel(e["name"])



plt.show()