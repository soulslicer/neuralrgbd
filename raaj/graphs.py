import numpy as np
import matplotlib.pyplot as plt

e1 = {
    "name": "raaj",
    "command:": "python train_raaj.py --exp_name raaj --nepoch 50 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4",
    "extra": "No other additions used",
    "test_interval": 5000,
    "rmse": [5.093856334686279, 4.498722076416016, 3.083822727203369, 2.7413127422332764, 2.699984073638916, 2.597834587097168, 2.502667188644409, 2.40141224861145, 3.5991766452789307, 2.275947332382202, 2.1963088512420654, 2.1019134521484375, 2.2240593433380127, 2.21748948097229, 2.290454149246216, 2.2462806701660156, 2.271103620529175, 2.185169219970703, 2.7858524322509766, 2.1395342350006104, 1.9764498472213745, 2.062957763671875, 2.163479804992676, 2.016000270843506, 1.8703045845031738, 2.0646743774414062, 1.8944143056869507, 2.0399537086486816, 2.13730788230896, 2.215651035308838, 2.3261260986328125, 1.9579334259033203, 2.0737788677215576, 1.9619027376174927, 1.9028606414794922, 2.306797504425049, 1.9389979839324951, 1.914262056350708, 2.009633779525757, 1.9145698547363281, 2.2240750789642334, 2.0640437602996826, 2.088416576385498, 1.900465488433838, 1.8838390111923218, 1.9438542127609253, 1.928377628326416, 2.0189850330352783, 1.970539927482605, 1.930024266242981, 1.9758362770080566, 1.9911922216415405, 1.9003195762634277, 1.9827296733856201, 1.9804960489273071, 1.8695687055587769, 1.864070177078247, 1.9628667831420898, 1.8480559587478638, 2.0715315341949463, 1.9965542554855347, 2.025421142578125, 2.006564140319824, 2.110764265060425, 1.9030420780181885],
    "sil": [0.26158812642097473, 0.1967812180519104, 0.11199184507131577, 0.09861795604228973, 0.09121604263782501, 0.08876412361860275, 0.08955056220293045, 0.0839523896574974, 0.12163680791854858, 0.0854288637638092, 0.08202575892210007, 0.07952307909727097, 0.07677242904901505, 0.07840321958065033, 0.08456078916788101, 0.07965028285980225, 0.07862308621406555, 0.07501637190580368, 0.09091439843177795, 0.0761035606265068, 0.07181143015623093, 0.07430735230445862, 0.075571209192276, 0.0726388469338417, 0.06761518120765686, 0.07377977669239044, 0.06762176752090454, 0.07432842254638672, 0.07548517733812332, 0.07138464599847794, 0.07756990194320679, 0.0711631178855896, 0.07281386852264404, 0.07083477079868317, 0.07010123133659363, 0.07605704665184021, 0.07219196110963821, 0.06702496111392975, 0.07214230298995972, 0.0678308755159378, 0.07449886947870255, 0.06777307391166687, 0.07074231654405594, 0.06976455450057983, 0.06713029742240906, 0.07206238806247711, 0.07098595798015594, 0.07062333822250366, 0.07174233347177505, 0.06837059557437897, 0.06968435645103455, 0.0753200352191925, 0.06763149797916412, 0.06898319721221924, 0.0694018229842186, 0.06712765991687775, 0.06486472487449646, 0.06982579082250595, 0.07017087936401367, 0.0713549330830574, 0.07224582135677338, 0.07089046388864517, 0.06899663805961609, 0.07482430338859558, 0.06527712196111679]
}

e2 = {
    "name": "raaj_mf1",
    "command:": "python train_raaj.py --exp_name raaj_mf1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 96 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_mf1",
    "extra": "ndepth 96 - No other additions used",
    "test_interval": 5000,
    "rmse": [5.195703983306885, 4.65868616104126, 3.5377135276794434, 2.9341824054718018, 2.706258773803711, 2.7388365268707275, 2.478070020675659, 3.417593002319336, 2.337862730026245, 2.296541213989258, 2.2968318462371826, 2.1265294551849365, 1.9956861734390259, 2.0230345726013184, 2.0877022743225098, 2.2974414825439453, 2.185784339904785, 2.1518218517303467, 2.120391845703125, 2.8898069858551025, 2.143223285675049, 1.982950210571289, 2.0073487758636475, 1.895858645439148, 2.049379587173462, 2.001389980316162, 2.071648597717285, 2.0930521488189697, 1.9212950468063354, 2.0387630462646484, 2.0552120208740234, 2.197216510772705, 1.9162636995315552, 1.8529934883117676, 2.0352776050567627, 1.8198702335357666, 2.133460760116577, 1.9431431293487549, 1.9804474115371704, 1.93356192111969, 2.0305659770965576, 1.8587629795074463, 1.9496488571166992, 2.105231761932373, 1.9596668481826782, 1.9199841022491455, 1.8950260877609253, 1.9052691459655762, 1.959879755973816, 2.010012626647949, 2.1151413917541504, 2.219541072845459, 1.9793587923049927, 1.9591171741485596, 2.0528318881988525, 1.9239814281463623, 1.7886089086532593, 2.04669189453125, 1.9935311079025269, 1.9541095495224, 1.8900656700134277, 1.8139231204986572],
    "sil": [0.27039363980293274, 0.20631657540798187, 0.12628380954265594, 0.10728859156370163, 0.09529860317707062, 0.10000000894069672, 0.08586668968200684, 0.12243708968162537, 0.08655080199241638, 0.08091390877962112, 0.08397180587053299, 0.0800696313381195, 0.07430945336818695, 0.07086760550737381, 0.07383409142494202, 0.08192123472690582, 0.07794768363237381, 0.07369215041399002, 0.07508103549480438, 0.10418067872524261, 0.07889533787965775, 0.07048554718494415, 0.07327713817358017, 0.06834347546100616, 0.0737384706735611, 0.07064533978700638, 0.07042582333087921, 0.0725897029042244, 0.06785178929567337, 0.06831105053424835, 0.06952415406703949, 0.08038594573736191, 0.0697150006890297, 0.06809490919113159, 0.0752694308757782, 0.06555580347776413, 0.07347354292869568, 0.06977535784244537, 0.0682215541601181, 0.06817197054624557, 0.07164578139781952, 0.06492552161216736, 0.06528902798891068, 0.07303399592638016, 0.07138415426015854, 0.06844847649335861, 0.06652173399925232, 0.06806715577840805, 0.06798312067985535, 0.06797600537538528, 0.07175613194704056, 0.07280725240707397, 0.06797964870929718, 0.0669531375169754, 0.06556729972362518, 0.06749900430440903, 0.06688980758190155, 0.06849171966314316, 0.07143059372901917, 0.07240311801433563, 0.06839664280414581, 0.06294700503349304]
}
# No diff

e3 = {
    "name": "raaj_twin1",
    "command": "python train_raaj.py --exp_name raaj_twin1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 1 --d_min 1 --d_max 60 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 4 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_twin1",
    "extra": "window 1 - No other additions used",
    "test_interval": 5000,
    "rmse": [5.105179309844971, 4.006272792816162, 3.088623285293579, 3.138909339904785, 2.646505832672119, 2.5787312984466553, 3.198941946029663, 2.4177796840667725, 2.325347661972046, 2.242929458618164, 2.214945077896118, 2.5018491744995117, 2.200016498565674, 2.1984331607818604, 2.1014132499694824, 2.2034413814544678, 2.0065553188323975, 2.415353536605835, 2.429755926132202, 2.1783206462860107, 2.1212289333343506, 2.046579122543335, 2.143327236175537, 2.046408176422119, 2.2017006874084473, 2.138862371444702, 2.1658174991607666, 2.176759719848633, 2.1712746620178223, 2.0337624549865723, 2.0235559940338135, 2.173267126083374, 2.1039857864379883, 1.9923440217971802, 2.165132761001587, 2.0839178562164307, 2.1456944942474365, 2.0723745822906494, 2.126204013824463, 2.1403629779815674, 2.0826380252838135, 1.9290753602981567, 2.191209077835083, 1.9939044713974, 2.162989854812622, 1.9836809635162354, 2.201716899871826, 2.022477626800537, 1.9430968761444092, 2.027268409729004, 1.8744386434555054, 1.8314805030822754, 2.1197848320007324, 2.0769855976104736, 2.0166168212890625, 2.040288209915161, 2.0873990058898926, 2.197990655899048, 2.026212692260742, 1.9322137832641602, 2.0165188312530518, 1.9234288930892944, 2.0072052478790283, 2.0094757080078125, 2.076672077178955, 1.9973496198654175],
    "sil": [0.24792838096618652, 0.16740867495536804, 0.11379584670066833, 0.10611653327941895, 0.09206517040729523, 0.08814600110054016, 0.11908292770385742, 0.08871482312679291, 0.08389449119567871, 0.0844595655798912, 0.08257250487804413, 0.08625250309705734, 0.07806437462568283, 0.07956703752279282, 0.07933555543422699, 0.07584880292415619, 0.07134933769702911, 0.08105015009641647, 0.08707275986671448, 0.07762641459703445, 0.08123563230037689, 0.07789096236228943, 0.07395145297050476, 0.07417525351047516, 0.07644640654325485, 0.07640951126813889, 0.07125870883464813, 0.07513962686061859, 0.07888054102659225, 0.07366501539945602, 0.07245692610740662, 0.07300794124603271, 0.07093164324760437, 0.06929079443216324, 0.07484788447618484, 0.07409676909446716, 0.07338400930166245, 0.07090247422456741, 0.07307107746601105, 0.07712771743535995, 0.07504631578922272, 0.0733078345656395, 0.07492096722126007, 0.06863073259592056, 0.07529031485319138, 0.07410766929388046, 0.07204100489616394, 0.06938248872756958, 0.07197623699903488, 0.07361017912626266, 0.06924110651016235, 0.06658665835857391, 0.07250573486089706, 0.07014849781990051, 0.07099266350269318, 0.07140034437179565, 0.07203096151351929, 0.07555754482746124, 0.07052288204431534, 0.06789953261613846, 0.07315032929182053, 0.0686427652835846, 0.07738097757101059, 0.06900538504123688, 0.07168947905302048, 0.06886284798383713],
    "rmse_low": [9.387350082397461, 9.48530387878418, 8.949586868286133, 8.85673713684082, 8.761672973632812, 8.486278533935547, 8.643424987792969, 8.406966209411621, 8.662148475646973, 8.66313362121582, 8.373432159423828, 8.346526145935059, 8.494088172912598, 8.38525390625, 8.06932258605957, 8.164669036865234, 7.844440937042236, 8.548027038574219, 8.570855140686035, 8.37795639038086, 8.168303489685059, 8.274438858032227, 8.112232208251953, 8.289798736572266, 8.219616889953613, 8.108441352844238, 7.8657636642456055, 8.318105697631836, 8.176082611083984, 8.382122039794922, 8.319441795349121, 7.992599010467529, 8.005608558654785, 8.238548278808594, 7.907147407531738, 8.324141502380371, 7.928425312042236, 7.953005790710449, 8.23534870147705, 8.343987464904785, 8.298556327819824, 8.20532512664795, 8.118729591369629, 8.171489715576172, 8.029925346374512, 8.145227432250977, 7.9570441246032715, 8.008953094482422, 7.994785785675049, 8.027801513671875, 8.066059112548828, 8.284883499145508, 8.04309368133545, 8.01082706451416, 8.120413780212402, 8.186248779296875, 8.174162864685059, 7.836660385131836, 8.136153221130371, 8.086731910705566, 8.08903694152832, 7.997220993041992, 8.259167671203613, 8.14563274383545, 8.270663261413574, 7.916408061981201],
    "sil_low": [11.010351181030273, 11.009678840637207, 10.861275672912598, 11.058639526367188, 10.872323036193848, 10.943059921264648, 10.905016899108887, 10.753173828125, 10.97367000579834, 10.891971588134766, 10.892780303955078, 10.889336585998535, 10.91043472290039, 10.896462440490723, 10.795509338378906, 10.898025512695312, 10.611405372619629, 10.949257850646973, 10.895898818969727, 10.970108985900879, 10.905513763427734, 11.019758224487305, 10.868256568908691, 10.966979026794434, 10.991874694824219, 11.006052017211914, 10.742094039916992, 10.893148422241211, 10.85714054107666, 10.919564247131348, 10.880197525024414, 10.755440711975098, 10.838709831237793, 10.783918380737305, 10.747679710388184, 11.046639442443848, 10.901399612426758, 10.810190200805664, 10.999687194824219, 10.88733959197998, 10.900594711303711, 10.88924503326416, 10.795316696166992, 10.853818893432617, 10.852339744567871, 10.88115406036377, 10.978691101074219, 10.969971656799316, 10.852956771850586, 10.810371398925781, 10.891799926757812, 10.92623519897461, 10.943622589111328, 10.911148071289062, 10.824097633361816, 10.886970520019531, 10.986698150634766, 10.786054611206055, 10.934383392333984, 10.803182601928711, 10.868988990783691, 10.826774597167969, 10.913909912109375, 10.870797157287598, 10.818607330322266, 10.895665168762207]
}
# No diff - hmm

e4 = {
    "name": "raaj_baseline540",
    "command": "python train_raaj.py --exp_name raaj_baseline540 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --test --pre_trained_folder outputs/saved_models/raaj_baseline540",
    "extra": "5 to 40",
    "test_interval": 5000,
    "rmse": [4.229862213134766, 3.6222305297851562, 2.0082919597625732, 1.636533260345459, 1.6388236284255981, 1.4344103336334229, 1.4327787160873413, 1.4114216566085815, 1.3435089588165283, 1.66750168800354, 1.32003915309906, 1.7270084619522095, 1.1958893537521362, 1.330750584602356, 1.2440299987792969, 1.2210124731063843, 1.1991040706634521, 1.2017337083816528, 1.3615401983261108, 1.217840552330017, 1.2201138734817505, 1.2543891668319702, 1.1298198699951172, 1.2208038568496704, 1.2628980875015259, 1.144845962524414, 1.1789944171905518, 1.2295364141464233, 1.1730146408081055, 1.130138874053955, 1.3473596572875977, 1.2267149686813354, 1.1690516471862793, 1.2968417406082153, 1.2272688150405884],
    "sil": [0.2511949837207794, 0.18828395009040833, 0.09787227213382721, 0.0741753950715065, 0.07473859190940857, 0.06933587789535522, 0.06963236629962921, 0.0700901597738266, 0.06641983240842819, 0.07536419481039047, 0.0637948289513588, 0.07551348209381104, 0.06082845479249954, 0.06645268201828003, 0.05922376364469528, 0.05942661687731743, 0.05770000070333481, 0.05689742788672447, 0.06679761409759521, 0.05878855660557747, 0.05812681466341019, 0.0603024885058403, 0.0555046945810318, 0.057468514889478683, 0.06528430432081223, 0.055262185633182526, 0.05756218358874321, 0.05736519396305084, 0.05569664016366005, 0.053307369351387024, 0.06070532649755478, 0.05684425309300423, 0.057593900710344315, 0.05765438824892044, 0.05964833125472069],
    "rmse_low": [6.632779598236084, 6.60107421875, 6.503622531890869, 6.241087436676025, 6.003207206726074, 6.29230260848999, 6.127127170562744, 6.150180816650391, 6.264333724975586, 6.199611663818359, 6.021917819976807, 6.283011436462402, 5.93574857711792, 6.119775295257568, 6.209653854370117, 5.973878383636475, 6.018228530883789, 5.977176666259766, 6.2647881507873535, 6.136696815490723, 5.988452434539795, 6.269497871398926, 5.829348087310791, 6.055513381958008, 6.224493503570557, 5.831354141235352, 5.8751654624938965, 6.200830936431885, 5.983264923095703, 6.0962605476379395, 6.149947166442871, 6.015904903411865, 5.975306510925293, 6.192714691162109, 6.2354655265808105],
    "sil_low": [10.900668144226074, 10.931844711303711, 11.020472526550293, 11.003358840942383, 10.840984344482422, 11.028319358825684, 10.936239242553711, 11.026156425476074, 10.919473648071289, 10.939018249511719, 10.840045928955078, 11.01020336151123, 10.919669151306152, 11.01859188079834, 11.12957763671875, 10.88113784790039, 10.966400146484375, 10.776030540466309, 10.965736389160156, 10.935880661010742, 10.905635833740234, 10.925024032592773, 10.769965171813965, 10.952581405639648, 10.897540092468262, 10.809033393859863, 10.844735145568848, 10.88115406036377, 10.835250854492188, 10.97878360748291, 10.786008834838867, 10.811653137207031, 10.80908489227295, 11.088641166687012, 11.011903762817383]
}
# In General 5 to 40 is much better

e5 = {
    "name": "raaj_540_m1",
    "command": " python train_raaj.py --exp_name raaj_540_m1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --drefine m1 --test --pre_trained_folder outputs/saved_models/raaj_540_m1",
    "extra": "5 to 40 and m1",
    "test_interval": 5000,
    "rmse": [4.105212211608887, 3.568232536315918, 2.088038921356201, 1.5752943754196167, 1.5702096223831177, 1.5370473861694336, 1.418892502784729, 1.4028244018554688, 1.4031087160110474, 1.3535025119781494, 1.282649278640747, 2.2237818241119385, 1.2284560203552246, 1.271148920059204, 1.2650411128997803, 1.3118821382522583, 1.223910927772522, 1.2110495567321777, 1.2607561349868774, 1.2063473463058472, 1.2254571914672852, 1.1866544485092163, 1.1906156539916992, 1.21925687789917, 1.2467395067214966, 1.2126215696334839, 1.2432552576065063, 1.2415845394134521, 1.1754215955734253, 1.1725670099258423, 1.5888413190841675, 1.1488279104232788, 1.2134029865264893, 1.2331615686416626, 1.2385475635528564],
    "sil": [0.2358914315700531, 0.1858472377061844, 0.10104960203170776, 0.07478533685207367, 0.07553042471408844, 0.07435166835784912, 0.07038015872240067, 0.0676378458738327, 0.06812285631895065, 0.06707227230072021, 0.062272652983665466, 0.09765560179948807, 0.06194177269935608, 0.06106923520565033, 0.06246740743517876, 0.06286059319972992, 0.059609126299619675, 0.05767040327191353, 0.06556499004364014, 0.05765658617019653, 0.05795292928814888, 0.05763782933354378, 0.0572710745036602, 0.059148382395505905, 0.060543131083250046, 0.05720554664731026, 0.06035512313246727, 0.05845491960644722, 0.056698787957429886, 0.057663366198539734, 0.07239054143428802, 0.05504174530506134, 0.0586506649851799, 0.05901633948087692, 0.061047982424497604],
    "rmse_low": [6.28715705871582, 5.340061187744141, 5.636441707611084, 5.5721354484558105, 5.322903633117676, 5.358699798583984, 5.793642997741699, 5.583754539489746, 5.646772384643555, 5.7928314208984375, 5.416904449462891, 4.867012023925781, 5.537990570068359, 5.317264080047607, 5.584013938903809, 5.303674221038818, 5.718224048614502, 5.2732954025268555, 5.682480335235596, 5.60322904586792, 5.251258850097656, 5.544861316680908, 5.2609453201293945, 5.268185615539551, 5.772985458374023, 5.307675361633301, 5.276197910308838, 5.17387056350708, 5.415724277496338, 5.125151634216309, 5.077411651611328, 5.346170902252197, 5.350520133972168, 5.2349677085876465, 5.521369934082031],
    "sil_low": [11.074728965759277, 10.94328784942627, 10.986061096191406, 10.990301132202148, 10.899333000183105, 10.975531578063965, 10.927848815917969, 11.011000633239746, 10.825115203857422, 11.086544036865234, 10.971060752868652, 10.824156761169434, 10.938796997070312, 10.947114944458008, 10.863883972167969, 10.982586860656738, 10.91864013671875, 10.924561500549316, 10.916727066040039, 10.914888381958008, 10.958062171936035, 10.93350887298584, 10.908646583557129, 10.824254035949707, 10.89043140411377, 10.934623718261719, 10.892966270446777, 11.023200035095215, 10.843644142150879, 10.688716888427734, 10.926237106323242, 10.844612121582031, 10.888269424438477, 10.757411003112793, 10.958722114562988]
}
# Compared to E4, adding M1 improved the rmse_low a fair bit

e6 = {
    "name": "raaj_n2",
    "command": "python train_raaj.py --exp_name raaj_n2 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --pytorch_scaling --drefine m1 --test --pre_trained_folder outputs/saved_models/raaj_n2",
    "extra": "Next Experiment, simulteanously run m1 (if better), leftright, 540, pytorch scaling, no soft CE",
    "test_interval": 5000,
    "rmse": [4.034736156463623, 3.1918461322784424, 2.186826705932617, 1.738223671913147, 1.5913501977920532, 1.6032401323318481, 1.5015172958374023, 1.5270920991897583, 1.5043590068817139, 1.5665539503097534, 1.3721814155578613, 1.9769960641860962, 1.3636409044265747, 1.467070460319519, 1.3085930347442627, 1.3765840530395508, 1.2765655517578125, 1.3378092050552368, 1.3055858612060547, 1.3115607500076294, 1.2721213102340698, 1.2691106796264648, 1.2775107622146606, 1.203289270401001, 1.4061074256896973, 1.3739243745803833, 1.2379976511001587, 1.2642666101455688, 1.1451696157455444, 1.1873366832733154, 1.632983922958374, 1.2307606935501099, 1.2228262424468994, 1.2644745111465454, 1.2616409063339233],
    "sil": [0.24293085932731628, 0.15690107643604279, 0.10698635876178741, 0.08493755012750626, 0.07721346616744995, 0.07956739515066147, 0.07506003975868225, 0.0741707980632782, 0.07486945390701294, 0.07289821654558182, 0.06728655099868774, 0.08847984671592712, 0.06863167136907578, 0.06873831897974014, 0.06449538469314575, 0.06577938795089722, 0.06294336169958115, 0.0653962641954422, 0.06624968349933624, 0.06331400573253632, 0.058759503066539764, 0.06128290668129921, 0.06208774447441101, 0.05829278379678726, 0.0672561451792717, 0.06382212042808533, 0.060529738664627075, 0.05927733704447746, 0.0554204136133194, 0.057509373873472214, 0.07454859465360641, 0.058688558638095856, 0.06045660004019737, 0.05981244146823883, 0.06346287578344345],
    "rmse_low": [4.247191905975342, 3.6053147315979004, 3.4016613960266113, 3.1857197284698486, 2.9923527240753174, 2.257383108139038, 1.8761451244354248, 1.7140065431594849, 1.717737078666687, 1.7124319076538086, 1.530569076538086, 2.0805647373199463, 1.5730026960372925, 1.5360032320022583, 1.4029638767242432, 1.5316545963287354, 1.4522353410720825, 1.4779678583145142, 1.435940146446228, 1.4606379270553589, 1.401645541191101, 1.4192228317260742, 1.487271785736084, 1.365108847618103, 1.5362324714660645, 1.4344147443771362, 1.3557398319244385, 1.4158756732940674, 1.2999287843704224, 1.316702127456665, 1.9272799491882324, 1.4682683944702148, 1.3217564821243286, 1.4129385948181152, 1.3970847129821777],
    "sil_low": [0.25955095887184143, 0.1779245138168335, 0.1521865874528885, 0.1402117908000946, 0.13256403803825378, 0.10482773929834366, 0.09096219390630722, 0.08411972969770432, 0.08386164158582687, 0.08071376383304596, 0.07722516357898712, 0.09493406862020493, 0.0839143916964531, 0.07314100116491318, 0.06866168975830078, 0.0757865458726883, 0.072093166410923, 0.07275279611349106, 0.07422854751348495, 0.07328110933303833, 0.06637722253799438, 0.06991537660360336, 0.07583726942539215, 0.0674208253622055, 0.0742025226354599, 0.06893189996480942, 0.06774844974279404, 0.06640709936618805, 0.0665251761674881, 0.06763379275798798, 0.08827924728393555, 0.07480869442224503, 0.06619646400213242, 0.06972858309745789, 0.07105886191129684]
}
# The error is slightly higher in rmse here, but now LOW is giving a good result finally

e7 = {
    "name": "raaj_n1",
    "command": "python train_raaj.py --exp_name raaj_n1 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --pytorch_scaling --drefine m1 --softce 0.1 --test --pre_trained_folder outputs/saved_models/raaj_n1",
    "extra": "Next Experiment, simulteanously run m1 (if better), leftright, 540, pytorch scaling, and SOFT CE 0.1",
    "test_interval": 5000,
    "rmse": [3.9653563499450684, 3.2732913494110107, 1.7825829982757568, 1.6563971042633057, 1.5377777814865112, 1.6012622117996216, 1.4865273237228394, 1.4221388101577759, 1.4128438234329224, 1.3219647407531738, 1.3383018970489502, 1.9510973691940308, 1.327571153640747, 1.2438745498657227, 1.2706549167633057, 1.2386324405670166, 1.291494607925415, 1.3369985818862915, 1.1606664657592773, 1.1783283948898315, 1.3314028978347778, 1.2283143997192383, 1.267006754875183, 1.1857681274414062, 1.235243558883667, 1.262844204902649, 1.2431612014770508, 1.2305057048797607, 1.2863985300064087, 1.203744649887085, 1.4004459381103516, 1.1846399307250977, 1.1414926052093506, 1.233895182609558, 1.1436034440994263],
    "sil": [0.22774316370487213, 0.16419604420661926, 0.08984693139791489, 0.07766134291887283, 0.0729682445526123, 0.0745333880186081, 0.07048169523477554, 0.06926404684782028, 0.06507156044244766, 0.06095586717128754, 0.06237350404262543, 0.08471103012561798, 0.06173891946673393, 0.05902816355228424, 0.05921217426657677, 0.05882071703672409, 0.06045088917016983, 0.06078612804412842, 0.05826101079583168, 0.055570121854543686, 0.060083236545324326, 0.05879523605108261, 0.05882041156291962, 0.056433722376823425, 0.05881444364786148, 0.057745762169361115, 0.057773131877183914, 0.057423774152994156, 0.05977357178926468, 0.056876372545957565, 0.06573393195867538, 0.056116215884685516, 0.05570850893855095, 0.058003492653369904, 0.056345321238040924],
    "rmse_low": [4.246157646179199, 3.608315944671631, 2.682523727416992, 2.457085371017456, 2.2695815563201904, 2.106719970703125, 1.9073656797409058, 1.7979369163513184, 1.640366554260254, 1.6251859664916992, 1.6865646839141846, 2.5588011741638184, 1.645727515220642, 1.5531010627746582, 1.6022826433181763, 1.4965258836746216, 1.5801591873168945, 1.6771842241287231, 1.3926682472229004, 1.4493480920791626, 1.6142178773880005, 1.5364952087402344, 1.4666411876678467, 1.3844765424728394, 1.5049411058425903, 1.463968276977539, 1.470015287399292, 1.4263155460357666, 1.4339884519577026, 1.3987785577774048, 2.1115872859954834, 1.3789407014846802, 1.3163847923278809, 1.4412375688552856, 1.315775990486145],
    "sil_low": [0.254129558801651, 0.1844857931137085, 0.13845908641815186, 0.12300119549036026, 0.11471150815486908, 0.0977606400847435, 0.09339483082294464, 0.08535785973072052, 0.07972923666238785, 0.07885903120040894, 0.08166366070508957, 0.11545469611883163, 0.07957913726568222, 0.07531670480966568, 0.07464700192213058, 0.07340824604034424, 0.07686622440814972, 0.07800175249576569, 0.07118229568004608, 0.07052137702703476, 0.0743410736322403, 0.07731078565120697, 0.07050447165966034, 0.06674206256866455, 0.07540517300367355, 0.07010538130998611, 0.06943592429161072, 0.06679242849349976, 0.06866077333688736, 0.06688189506530762, 0.09778518974781036, 0.0669001117348671, 0.06684434413909912, 0.06883114576339722, 0.06691990792751312]
}
# Performs better with soft ce of 0.1

e8 = {"rmse_low": [4.351901531219482, 3.482165575027466, 2.573094367980957, 2.3680758476257324, 2.169126510620117, 2.1784167289733887, 2.011815071105957, 1.950767993927002, 1.957285761833191, 1.8600807189941406, 1.6563444137573242, 3.3561182022094727, 1.6751620769500732, 1.7379952669143677, 1.6330002546310425, 1.6909329891204834, 1.6252586841583252, 1.6226321458816528, 1.5778392553329468, 1.6265209913253784, 1.5808855295181274, 1.6057595014572144, 1.5556561946868896, 1.4971588850021362, 1.4502341747283936, 1.5063984394073486, 1.4660700559616089, 1.5388402938842773, 1.419522762298584, 1.4624155759811401, 2.226408004760742, 1.3794033527374268, 1.451188087463379, 1.4299591779708862, 1.4780198335647583], "command": "--exp_name raaj_n3 --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --pytorch_scaling --drefine m1 --softce 0.2 --test --pre_trained_folder outputs/saved_models/raaj_n3", "name": "raaj_n3", "rmse": [4.136064052581787, 3.614063262939453, 2.003192901611328, 1.8171336650848389, 1.7187538146972656, 1.4850696325302124, 1.3331068754196167, 1.414286494255066, 1.3633352518081665, 1.2612333297729492, 1.2617355585098267, 2.465932846069336, 1.2932519912719727, 1.3503490686416626, 1.2264633178710938, 1.3321688175201416, 1.1698282957077026, 1.2326312065124512, 1.1855494976043701, 1.2125777006149292, 1.3307585716247559, 1.1719908714294434, 1.2554086446762085, 1.190202236175537, 1.0823745727539062, 1.2369906902313232, 1.1576625108718872, 1.2379655838012695, 1.1731501817703247, 1.163901925086975, 1.622201919555664, 1.1104289293289185, 1.1817495822906494, 1.1754390001296997, 1.140001893043518], "sil_low": [0.2669989764690399, 0.18137751519680023, 0.13188064098358154, 0.11419330537319183, 0.10469118505716324, 0.09962804615497589, 0.09906954318284988, 0.09086981415748596, 0.09127573668956757, 0.09090344607830048, 0.08126836270093918, 0.14707088470458984, 0.08314905315637589, 0.0808289647102356, 0.07544301450252533, 0.08011611551046371, 0.07618729770183563, 0.07541823387145996, 0.07962391525506973, 0.08043120801448822, 0.07642160356044769, 0.07333143055438995, 0.07555115222930908, 0.07048096507787704, 0.07257387042045593, 0.06886705756187439, 0.06792810559272766, 0.06993751227855682, 0.06916430592536926, 0.06723009049892426, 0.09579520672559738, 0.06719448417425156, 0.0689297765493393, 0.0667385384440422, 0.07444898784160614], "test_interval": 5000, "rsc": [0.4279206097126007, 0.4031267464160919, 0.3166625201702118, 0.2918885052204132, 0.29840075969696045, 0.2903614640235901, 0.28235429525375366, 0.2794887125492096, 0.28001081943511963, 0.2759130895137787, 0.28034698963165283, 0.33815887570381165, 0.2898089289665222, 0.2731319069862366, 0.2688208520412445, 0.2812793552875519, 0.26689398288726807, 0.2647339403629303, 0.2756911516189575, 0.27764642238616943, 0.28803056478500366, 0.2725522518157959, 0.28123265504837036, 0.2774592339992523, 0.27025559544563293, 0.2653715908527374, 0.2675105333328247, 0.28366509079933167, 0.27566078305244446, 0.2698308527469635, 0.29757797718048096, 0.2746129631996155, 0.2788867950439453, 0.28023040294647217, 0.27797961235046387], "smooth": [0.38502034544944763, 0.44591259956359863, 0.5311122536659241, 0.37714630365371704, 0.3642829656600952, 0.3754097819328308, 0.3852390646934509, 0.38540351390838623, 0.39583563804626465, 0.3980294167995453, 0.3680863380432129, 0.2591436803340912, 0.3631553649902344, 0.3958170711994171, 0.39017078280448914, 0.39503493905067444, 0.38272300362586975, 0.3950462341308594, 0.388990193605423, 0.3746941387653351, 0.3751128911972046, 0.3613283336162567, 0.3802501857280731, 0.3760739862918854, 0.37814441323280334, 0.36483851075172424, 0.3829818069934845, 0.38381949067115784, 0.38283467292785645, 0.3728407323360443, 0.3205598294734955, 0.3981765806674957, 0.37094223499298096, 0.3932327330112457, 0.4166865646839142], "dc": [0.045845359563827515, 0.12164470553398132, 0.08870276063680649, 0.08075311779975891, 0.07977928221225739, 0.07449689507484436, 0.07057151198387146, 0.06435798853635788, 0.0653688907623291, 0.0638628751039505, 0.05177908390760422, 0.06267113238573074, 0.05270789936184883, 0.05328182131052017, 0.04802091419696808, 0.05267370119690895, 0.0459713451564312, 0.04600810259580612, 0.04509720206260681, 0.045185934752225876, 0.0450904555618763, 0.04932589456439018, 0.041651349514722824, 0.04112747311592102, 0.046377990394830704, 0.039090726524591446, 0.04070102795958519, 0.03736261650919914, 0.03857896476984024, 0.037180423736572266, 0.044311124831438065, 0.03476371616125107, 0.03486824408173561, 0.03485076501965523, 0.03964447230100632], "sil": [0.25014522671699524, 0.1884683072566986, 0.09992039203643799, 0.0816541388630867, 0.07570820301771164, 0.07068474590778351, 0.06284922361373901, 0.06519698351621628, 0.06409012526273727, 0.06099924445152283, 0.06203267723321915, 0.10485473275184631, 0.06178166717290878, 0.06080729141831398, 0.05698268115520477, 0.06021745875477791, 0.05468246340751648, 0.057365499436855316, 0.05965888500213623, 0.058097682893276215, 0.060217246413230896, 0.054067984223365784, 0.058363743126392365, 0.055564165115356445, 0.052971601486206055, 0.0554334856569767, 0.053288184106349945, 0.056817427277565, 0.054810576140880585, 0.05346214026212692, 0.07066384702920914, 0.05292049050331116, 0.05539184436202049, 0.05423963442444801, 0.0545601062476635]}
# Soft ce of 0.2

e9 = {"rmse_low": [3.9520390033721924, 3.5819027423858643, 2.6166374683380127, 2.3576769828796387, 2.007699966430664, 1.835992693901062, 1.6999636888504028, 1.5418323278427124, 1.7303624153137207, 1.5879851579666138, 1.4923022985458374, 1.8644342422485352, 1.546692132949829, 1.40857994556427, 1.3905915021896362, 1.369956135749817, 1.3631367683410645, 1.3611873388290405, 1.2720396518707275, 1.4154744148254395, 1.35776948928833, 1.2793351411819458, 1.3748483657836914, 1.3407773971557617, 1.304635763168335, 1.3324594497680664, 1.3702229261398315, 1.255845546722412, 1.2400165796279907, 1.3356382846832275, 1.6547133922576904, 1.4524478912353516, 1.4567499160766602, 1.3376094102859497, 1.2662335634231567], "command": "--exp_name raaj_dsc --nepoch 60 --RNet --sigma_soft_max 10 --LR 1e-5 --t_win 2 --d_min 5 --d_max 40 --feature_dim 64 --ndepth 64 --grad_clip --grad_clip_max 2. --dataset kitti --dataset_path ../data/datasets/kitti/ --batch_size 8 --qpower 1.5 --ngpu 4 --pytorch_scaling --drefine m1 --softce 0.1 --dsc_mul 1 --test --pre_trained_folder outputs/saved_models/raaj_dsc", "name": "raaj_dsc", "rmse": [3.889071226119995, 3.3481669425964355, 1.8436925411224365, 1.5148208141326904, 1.4240366220474243, 1.424113392829895, 1.339016079902649, 1.2652983665466309, 1.4766710996627808, 1.316740870475769, 1.3131064176559448, 1.6131008863449097, 1.3568439483642578, 1.2452341318130493, 1.2216880321502686, 1.1695334911346436, 1.1831448078155518, 1.2008665800094604, 1.1349236965179443, 1.2428858280181885, 1.1896262168884277, 1.12447190284729, 1.2368059158325195, 1.1985857486724854, 1.1883505582809448, 1.2123582363128662, 1.2283828258514404, 1.1325368881225586, 1.0694260597229004, 1.2020574808120728, 1.4905288219451904, 1.3195604085922241, 1.2950060367584229, 1.2206069231033325, 1.150598168373108], "sil_low": [0.2249957174062729, 0.18381546437740326, 0.12906882166862488, 0.12520700693130493, 0.10342631489038467, 0.09135289490222931, 0.09024354070425034, 0.07861119508743286, 0.08598827570676804, 0.08742105960845947, 0.0745844691991806, 0.09025460481643677, 0.0766543298959732, 0.07105940580368042, 0.07000220566987991, 0.06963755935430527, 0.07031062245368958, 0.06832186877727509, 0.06733361631631851, 0.07047223299741745, 0.06941886246204376, 0.06567854434251785, 0.07210152596235275, 0.06743158400058746, 0.06420532613992691, 0.06563665717840195, 0.0683348998427391, 0.0632861852645874, 0.06365426629781723, 0.06695597618818283, 0.07777196168899536, 0.069102942943573, 0.0739455595612526, 0.06641943752765656, 0.06329607218503952], "test_interval": 5000, "rsc": [0.42144981026649475, 0.38386988639831543, 0.3002606928348541, 0.2811923027038574, 0.27280929684638977, 0.28782492876052856, 0.2768605351448059, 0.28337982296943665, 0.2869630753993988, 0.30030888319015503, 0.27493980526924133, 0.2991202175617218, 0.27347204089164734, 0.28262484073638916, 0.2779143452644348, 0.2773931324481964, 0.2696521282196045, 0.26731452345848083, 0.2752070128917694, 0.2759858965873718, 0.27465322613716125, 0.2780401408672333, 0.2816530466079712, 0.27903416752815247, 0.2682593762874603, 0.2665409743785858, 0.2818765640258789, 0.2824167013168335, 0.26462289690971375, 0.27832064032554626, 0.2822808027267456, 0.26885536313056946, 0.27766725420951843, 0.2780134081840515, 0.2689490020275116], "smooth": [0.34746283292770386, 0.39851659536361694, 0.49921736121177673, 0.4163685441017151, 0.3951245844364166, 0.37199288606643677, 0.36788704991340637, 0.3762976825237274, 0.37316298484802246, 0.3704836964607239, 0.3637891709804535, 0.3428099453449249, 0.3966344892978668, 0.3639203608036041, 0.3877018392086029, 0.37379077076911926, 0.4032481014728546, 0.41059452295303345, 0.3575613796710968, 0.3625676929950714, 0.34798237681388855, 0.34908267855644226, 0.33496224880218506, 0.34282854199409485, 0.3410147726535797, 0.35892271995544434, 0.3471481502056122, 0.3459821939468384, 0.3318212926387787, 0.3453749418258667, 0.3049708902835846, 0.36406877636909485, 0.33420228958129883, 0.32996466755867004, 0.3553442656993866], "dc": [0.068821020424366, 0.1086827963590622, 0.08412393182516098, 0.08725692331790924, 0.0746142715215683, 0.058234650641679764, 0.054304588586091995, 0.04791104793548584, 0.051188550889492035, 0.045895230025053024, 0.03749921917915344, 0.03626006096601486, 0.03677442669868469, 0.03286090865731239, 0.04210449755191803, 0.03564704209566116, 0.03390520066022873, 0.034815069288015366, 0.03128568455576897, 0.03368077427148819, 0.034081265330314636, 0.03367798402905464, 0.03377268835902214, 0.03140965476632118, 0.029207482933998108, 0.028828216716647148, 0.030472422018647194, 0.028795797377824783, 0.030229652300477028, 0.02855338715016842, 0.030449485406279564, 0.029391011223196983, 0.03410680964589119, 0.027532659471035004, 0.025954872369766235], "sil": [0.22409650683403015, 0.16754552721977234, 0.08775343745946884, 0.07352665066719055, 0.06729312986135483, 0.07016747444868088, 0.06493254750967026, 0.06340259313583374, 0.06910672038793564, 0.0668998658657074, 0.06244760379195213, 0.07376411557197571, 0.0635848268866539, 0.059127625077962875, 0.05838075280189514, 0.055834490805864334, 0.05810438096523285, 0.05800503492355347, 0.05767131596803665, 0.05857327952980995, 0.057648926973342896, 0.054589658975601196, 0.05963060259819031, 0.05718875676393509, 0.05678747221827507, 0.056288622319698334, 0.05839506536722183, 0.05600426718592644, 0.05151480436325073, 0.056902144104242325, 0.06522700190544128, 0.05856234207749367, 0.060976434499025345, 0.057619065046310425, 0.055713482201099396]}
# dsc_mul to 1

# e = e1
# time = np.arange(0,len(e["rmse"]))*e["test_interval"]
# #plt.plot(time, e["rmse"])
# plt.plot(time, e["sil"])
# plt.ylabel(e["name"])

# e = e4
# time = np.arange(0,len(e["rmse"]))*e["test_interval"]
# #plt.plot(time, e["rmse"])
# plt.plot(time, e["sil"])
# plt.ylabel(e["name"])

# e = e6
# time = np.arange(0,len(e["rmse"]))*e["test_interval"]
# #plt.plot(time, e["rmse"])
# plt.plot(time, e["sil_low"])
# plt.ylabel(e["name"])
#

e = e8
time = np.arange(0,len(e["rmse"]))*e["test_interval"]
#plt.plot(time, e["rmse"])
plt.plot(time, e["rsc"])
plt.ylabel(e["name"])

e = e9
time = np.arange(0,len(e["rmse"]))*e["test_interval"]
#plt.plot(time, e["rmse"])
plt.plot(time, e["rsc"])
plt.ylabel(e["name"])



plt.show()